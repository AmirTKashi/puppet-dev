# Reference
<!-- DO NOT EDIT: This document was generated by Puppet Strings -->

## Table of Contents

**Classes**

* [`ud::cert`](#udcert): Obtain LetsEncrypt certificate
* [`ud::container::host`](#udcontainerhost): Configure host to be capable of running containers via `podman`
* [`ud::profile::apache`](#udprofileapache): Configure the Apache web server
* [`ud::profile::base`](#udprofilebase): Common base profile applied to all machines
* [`ud::profile::puppet::master`](#udprofilepuppetmaster): Configure Puppet master
* [`ud::role::puppet::master`](#udrolepuppetmaster): Puppet master role

**Defined types**

* [`ud::config`](#udconfig): Apply values to configuration files using Augeas
* [`ud::config::lookup`](#udconfiglookup): Apply values to configuration files using Augeas and a lookup hash
* [`ud::container`](#udcontainer): Configure a `podman` container to run as a `systemd` service
* [`ud::package`](#udpackage): Install a package
* [`ud::user`](#uduser): Create a local user

**Functions**

* [`ud::hashlookup`](#udhashlookup): Look up a (possibly empty) hash in Hiera

## Classes

### ud::cert

This is intended to be included automatically by manifests that
define the mechanism used for certificate renewal, such as
[`ud::profile::apache`](#udprofileapache).  You should not need to
use this resource class directly.

#### Parameters

The following parameters are available in the `ud::cert` class.

##### `aliases`

Data type: `Array[String]`

Fully qualified DNS names to be included within the certificate

Default value: []

##### `deploy_hook_commands`

Data type: `Array[String]`

Commands to be run after a certificate deployment

Default value: []

##### `webroot`

Data type: `Optional[String]`

Web root directory (for when using the webroot plugin)

Default value: `undef`

##### `group`

Data type: `String`

Group granted access to the certificate's private key

Default value: 'certkeys'

##### `mode`

Data type: `String`

Access mode (e.g. '0640') for the certificate's private key

Default value: '0640'

### ud::container::host

This is intended to be included automatically by manifests that
require the ability to run containers such as
[`ud::container`](#udcontainer).  You should not need to use this
resource class directly.

### ud::profile::apache

This is intended to be invoked automatically by
[`ud::profile::base`](#udprofilebase) based on the YAML dictionary
[`ud::web`](README.md#udweb).  You should not need to use this
resource class directly.

#### Parameters

The following parameters are available in the `ud::profile::apache` class.

##### `aliases`

Data type: `Array[String]`

Fully qualified DNS names to be added to the TLS certificate.

Default value: []

##### `docroot`

Data type: `Optional[String]`

Document root for static files.

Default value: `undef`

##### `app_path`

Data type: `Optional[String]`

Relative URL path for a web application configured via a drop-in
Apache configuration file.

Default value: `undef`

##### `app_port`

Data type: `Optional[Integer]`

Port number for a web application configured to run as a service
listening for HTTP connections to `localhost` on a non-standard
port.

Default value: `undef`

##### `vhost`

Data type: `Hash`

Additional virtual host configuration parameters passed through
directly to the `apache::vhost` Puppet class.

Default value: {}

### ud::profile::base

This profile is applied automatically to all machines.  It is used
to give effect to various automagical YAML parameters such as
[`ud::users`](README.md#udusers) and
[`ud::packages`](README.md#udpackages).

### ud::profile::puppet::master

See the [design document](PUPPET.md) for detailed information.

#### Parameters

The following parameters are available in the `ud::profile::puppet::master` class.

##### `repo`

Data type: `Optional[String]`

Local Puppet repository name

Default value: $facts['puppet_repo']

### ud::role::puppet::master

Puppet master role

## Defined types

### ud::config

Take a hash mapping Augeas-style paths to configuration values
(e.g. `'/etc/ssh/sshd_config/PasswordAuthentication' => 'no'`), and
use Augeas to apply each value to each path in a single operation.

The [`ud::lenses`](README.md#udlenses) YAML dictionary may be used
to define Augeas lenses to be applied for non-standard filename
patterns.  For example:

```yaml
ud::lenses:
  ini:
    - /etc/myyapp.ini
  json:
    - /etc/myapp/*.json
```

#### Examples

##### Disable SSH password authentication

```puppet
ud::config { "sshpw":
  '/etc/ssh/sshd_config/PasswordAuthentication' => 'no',
  '/etc/ssh/sshd_config/ChallengeResponseAuthentication' => 'no',
}
```

#### Parameters

The following parameters are available in the `ud::config` defined type.

##### `values`

Data type: `Hash`

Hash mapping Augeas-style paths to configuration values

### ud::config::lookup

Take a hash mapping Augeas style paths to lookup keys
(e.g. `'/etc/myapp.ini/db/password' => 'password'`) and a second
hash mapping lookup keys to values (e.g. `'password' =>
'supersecret'`), and use Augeas to apply the looked-up value to each
path in a single operation.

This allows a manifest to construct a hash of configuration values
(such as database connection parameters) and apply these
configuration values to arbitrary custom file formats.

As with [`ud::config`](#udconfig), the
[`ud::lenses`](README.md#udlenses) YAML dictionary may be used to
define Augeas lenses to be applied for non-standard filename
patterns.

#### Examples

##### Database passwords

```puppet
ud::config::lookup { "database passwords":
  paths => {
    '/etc/myapp.ini/db/user' => 'username',
    '/etc/myapp.ini/db/password' => 'password',
  },
  values => {
    'username' => 'dbuser',
    'password' => 'supersecret',
  },
}
```

#### Parameters

The following parameters are available in the `ud::config::lookup` defined type.

##### `paths`

Data type: `Hash`

Hash mapping Augeas-style paths to lookup keys

Default value: {}

##### `values`

Data type: `Hash`

Hash mapping lookup keys to configuration values

Default value: {}

### ud::container

This is intended to be invoked automatically by
[`ud::profile::base`](#udprofilebase) based on the YAML dictionary
[`ud::containers`](README.md#udcontainers).  You should not need to
use this defined type directly.

#### Parameters

The following parameters are available in the `ud::container` defined type.

##### `image`

Data type: `String`

Container image name

Default value: $name

##### `command`

Data type: `String`

Container startup command

Default value: ''

##### `description`

Data type: `Optional[String]`

`systemd` service description

Default value: "${name} container"

##### `ports`

Data type: `Array[Variant[Integer, String]]`

List of exposed port mappings

Default value: []

##### `environment`

Data type: `Hash`

Dictionary of environment variables

Default value: {}

##### `volumes`

Data type: `Hash`

Dictionary of volumes

Default value: {}

##### `cert`

Data type: `Boolean`

Allow container to access host TLS certificate

Default value: `false`

##### `wrappers`

Data type: `Hash`

Dictionary of host commands to map to container commands

Default value: {}

### ud::package

This is intended to be invoked automatically by
[`ud::profile::base`](#udprofilebase) based on the YAML array
[`ud::packages`](README.md#udpackages).  You should not need to use
this defined type directly.

#### Parameters

The following parameters are available in the `ud::package` defined type.

##### `name`

Package name

##### `ensure`

Data type: `String`

Desired state ('present' or 'absent')

Default value: 'present'

### ud::user

This is intended to be invoked automatically by
[`ud::profile::base`](#udprofilebase) based on the YAML dictionary
[`ud::users`](README.md#udusers).  You should not need to use this
defined type directly.

#### Parameters

The following parameters are available in the `ud::user` defined type.

##### `name`

User name

##### `ensure`

Data type: `String`

Desired state ('present' or 'absent')

Default value: 'present'

##### `sudo`

Data type: `Boolean`

User should be able to execute commands as root

Default value: `true`

##### `keys`

Data type: `Array[String]`

Optional list of SSH authorized keys

Default value: []

##### `groups`

Data type: `Array[String]`

Optional list of supplementary groups

Default value: []

## Functions

### ud::hashlookup

Type: Puppet Language

Look up a (possibly empty) hash in Hiera

#### `ud::hashlookup(String $key, Optional[Hash] $default = undef)`

The ud::hashlookup function.

Returns: `Optional[Hash]` Hash value

##### `key`

Data type: `String`

Lookup key

##### `default`

Data type: `Optional[Hash]`

Default value if not found

